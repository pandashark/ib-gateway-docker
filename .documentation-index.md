# Documentation Index

This project maintains documentation across multiple files. Here's where to find what you need:

## For Users
- **README.md** - Main user documentation for running IB Gateway/TWS in Docker
  - Installation and quick start
  - Configuration options (all environment variables)
  - SSH tunnel setup guide (lines 365-455)
  - Security considerations for network exposure (lines 312-364)

## For Developers

### Architecture & Module Documentation
- **scripts-CLAUDE.md** - Scripts module architecture and patterns
  - Startup sequence and orchestration
  - SSH tunnel system design
  - Port forwarding implementation
  - Key security patterns for shell scripts
  - Testing and validation procedures

### Security Documentation
- **SECURITY.md** - Security patterns and vulnerability mitigation
  - CWE-78 command injection fix (commit ce2847e)
  - Secure shell scripting patterns (REQUIRED reading before modifying scripts)
  - Environment variable risk assessment
  - Security test suite documentation
  - Threat model and defense-in-depth measures
  - Code review checklist

### Task & Session Management
- **CLAUDE.md** - Claude Code sessions system documentation
  - Collaboration philosophy
  - Task management best practices
  - Specialized agent usage
  - Protocol management

### Tests
- **tests/security_test_ssh_injection.sh** - Automated security validation
  - 6 comprehensive injection prevention tests
  - Run before any script modifications
  - Required to pass in CI/CD

## Modified Files (2025-10-14 Security Fix)

### Core Changes
- stable/scripts/run_ssh.sh:20 - Direct execution pattern (removed bash -c)
- latest/scripts/run_ssh.sh:20 - Direct execution pattern (removed bash -c)
- image-files/scripts/run_ssh.sh:20 - Direct execution pattern (removed bash -c)

### Documentation Added
- scripts-CLAUDE.md - Module architecture documentation
- SECURITY.md - Security patterns and guidelines
- tests/security_test_ssh_injection.sh - Security validation suite

## Quick Reference

### Run Security Tests
```bash
./tests/security_test_ssh_injection.sh
```

### Validate Shell Scripts
```bash
shellcheck -x stable/scripts/*.sh
shellcheck -x latest/scripts/*.sh
shellcheck -x image-files/scripts/*.sh
```

### Critical Security Rules
1. NEVER use `bash -c`, `eval`, or `sh -c` with variables
2. Quote all user-controlled string variables
3. Document intentional word splitting with shellcheck directives
4. Run shellcheck and security tests before committing
5. Apply changes to all three version directories (stable/latest/image-files)

See SECURITY.md for complete guidelines.
